name: Docker Hub Publish

on:
  repository_dispatch:
    types: [dockerhub-publish]
  workflow_dispatch:
    inputs:
      base_image:
        description: 'Base GHCR image'
        required: true
        default: 'ghcr.io/ai-pipestream/s3-connector'
      dockerhub_repo:
        description: 'Docker Hub repository'
        required: true
        default: 'pipestreamai/s3-connector'
      tags:
        description: 'Space-separated tags'
        required: true
        default: 'latest'

jobs:
  push-to-dockerhub:
    uses: ai-pipestream/.github/.github/workflows/reusable-dockerhub-publish.yml@main
    with:
      base_image: ${{ github.event.client_payload.base_image || inputs.base_image }}
      dockerhub_repo: ${{ github.event.client_payload.dockerhub_repo || inputs.dockerhub_repo }}
      tags: ${{ github.event.client_payload.tags || inputs.tags }}
    secrets:
      DOCKER_USER: ${{ secrets.DOCKER_USER }}
      DOCKER_TOKEN: ${{ secrets.DOCKER_TOKEN }}
