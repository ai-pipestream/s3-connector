# ======================================================================================================================
# Application
# ======================================================================================================================
quarkus.application.name=s3-connector
quarkus.application.version=1.0.0
# Container Image Configuration
quarkus.container-image.registry=ghcr.io
quarkus.container-image.group=ai-pipestream
quarkus.container-image.name=s3-connector
quarkus.container-image.tag=latest
quarkus.container-image.additional-tags=${quarkus.application.version}
# ======================================================================================================================
# HTTP / gRPC Configuration
# ======================================================================================================================
# S3 connector service port (38120)
quarkus.http.host=0.0.0.0
quarkus.http.port=38120
quarkus.grpc.server.use-separate-server=false
quarkus.grpc.server.enable-reflection-service=true
quarkus.grpc.server.max-inbound-message-size=2147483647
# Dev configuration
%dev.quarkus.http.port=38120
%dev.quarkus.http.host=0.0.0.0
# Test configuration
%test.quarkus.http.test-port=0
%test.quarkus.grpc.server.use-separate-server=false
# ======================================================================================================================
# Dev Services Configuration
# ======================================================================================================================
# General Dev Services
%dev.quarkus.devservices.enabled=true
# Docker Compose Dev Services (Dev Profile) - Use shared dev services via extension
%dev.quarkus.compose.devservices.enabled=true
%dev.quarkus.compose.devservices.files=${user.home}/.pipeline/compose-devservices.yml
%dev.quarkus.devservices.timeout=120s
%dev.quarkus.compose.devservices.start-services=true
%dev.quarkus.compose.devservices.stop-services=false
%dev.quarkus.compose.devservices.reuse-project-for-tests=true
%dev.quarkus.compose.devservices.stop-timeout=30s
%dev.quarkus.compose.devservices.project-name=pipeline-shared-devservices
# Disable Apicurio Registry DevServices - use the one from Compose Dev Services instead
%dev.quarkus.apicurio-registry.protobuf.devservices.enabled=true
# Test profile - use Quarkus DevServices (not compose)
%test.quarkus.devservices.enabled=true
%test.quarkus.compose.devservices.enabled=false
# MinIO via MinioTestResource (Testcontainers) - configured by @QuarkusTestResource
# Kafka/Apicurio via Quarkus DevServices
%test.quarkus.kafka.devservices.enabled=true
%test.quarkus.apicurio-registry.protobuf.devservices.enabled=true
# ======================================================================================================================
# Service Registration Configuration
# ======================================================================================================================
pipestream.registration.enabled=true
pipestream.registration.service-name=s3-connector
pipestream.registration.description=S3 connector service for crawling S3 buckets and processing objects
pipestream.registration.type=CONNECTOR
# Advertised host: what clients use to connect
pipestream.registration.advertised-host=${SERVICE_REGISTRATION_ADVERTISED_HOST:host.docker.internal}
pipestream.registration.advertised-port=${quarkus.http.port}
# Internal host: what Consul uses for health checks
pipestream.registration.internal-host=${SERVICE_REGISTRATION_INTERNAL_HOST:172.17.0.1}
pipestream.registration.internal-port=${quarkus.http.port}
pipestream.registration.capabilities=s3-crawling,bucket-scanning
pipestream.registration.tags=s3,connector,storage
%test.pipestream.registration.enabled=false
# Registration service connection
pipestream.registration.registration-service.host=localhost
pipestream.registration.registration-service.port=38101
# ======================================================================================================================
# Kafka Configuration
# ======================================================================================================================
kafka.bootstrap.servers=${KAFKA_BOOTSTRAP_SERVERS:localhost:9094}
%dev.kafka.bootstrap.servers=localhost:9094
%prod.kafka.bootstrap.servers=kafka:9092
# Kafka Dev Services
%dev.quarkus.kafka.devservices.enabled=true
# Apicurio Registry URL is AUTO-CONFIGURED by DevServices - do NOT set manually
%prod.mp.messaging.connector.smallrye-kafka.bootstrap.servers=${kafka.bootstrap.servers}
%prod.mp.messaging.connector.smallrye-kafka.apicurio.registry.url=http://apicurio-registry:8080/apis/registry/v3
# ======================================================================================================================
# Kafka Channels
# ======================================================================================================================
# S3 crawl events channel (for listing objects during initial/recrawl)
# Note: Connector ('smallrye-kafka') and Serializers/Deserializers (ProtobufKafkaSerializer/ProtobufKafkaDeserializer/UUIDSerializer) are 
# AUTO-CONFIGURED by the quarkus-apicurio-registry-protobuf extension.
# DO NOT manually configure 'value.serializer', 'value.deserializer', 'connector', or apicurio.registry.url unless you need to override the defaults.
#
# ======================================================================================================================
# AWS S3 Configuration
# ======================================================================================================================
# S3 endpoint (use MinIO endpoint for development, AWS S3 for production)
quarkus.s3.endpoint-override=${S3_ENDPOINT_OVERRIDE:}
%dev.quarkus.s3.endpoint-override=http://localhost:9000
# %test: endpoint set dynamically by MinioTestResource with random port
quarkus.s3.aws.region=${AWS_REGION:us-east-1}
%dev.quarkus.s3.aws.region=us-east-1
# AWS credentials (for MinIO, use minioadmin/minioadmin)
quarkus.s3.aws.credentials.type=static
quarkus.s3.aws.credentials.static-provider.access-key-id=${AWS_ACCESS_KEY_ID:minioadmin}
quarkus.s3.aws.credentials.static-provider.secret-access-key=${AWS_SECRET_ACCESS_KEY:minioadmin}
# Path-style access for MinIO
quarkus.s3.path-style-access=${S3_PATH_STYLE_ACCESS:true}
%dev.quarkus.s3.path-style-access=true
# ======================================================================================================================
# Connector Intake Service Configuration
# ======================================================================================================================
s3.connector.intake.base-url=${CONNECTOR_INTAKE_BASE_URL:http://localhost:38103}
s3.connector.intake.raw-path=/uploads/raw
s3.connector.intake.request-timeout=PT5M
# ======================================================================================================================
# S3 Connector Configuration
# ======================================================================================================================
# Crawl mode: initial-crawl, event-driven, or both
s3.connector.crawl-mode=${S3_CRAWL_MODE:initial-crawl}
# Initial crawl configuration
s3.connector.initial-crawl.enabled=true
s3.connector.initial-crawl.max-keys-per-request=1000
# Event-driven mode (S3 notifications) - to be implemented later
s3.connector.event-driven.enabled=false
# ======================================================================================================================
# Apicurio Registry Configuration
# ======================================================================================================================
quarkus.index-dependency.pipestream-registration.group-id=ai.pipestream
quarkus.index-dependency.pipestream-registration.artifact-id=pipestream-service-registration
